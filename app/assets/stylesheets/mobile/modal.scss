// base styles for every modal popup used in Discourse

@keyframes slideUp {
  from {
    transform: translateY(85%);
  }
  to {
    transform: translateY(0);
  }
}

@keyframes slideDown {
  from {
    transform: translateY(0);
  }
  to {
    transform: translateY(100%);
  }
}

.d-modal {
  align-items: flex-start;
  &__container {
    margin-top: calc(var(--composer-vh, var(--1dvh)) * 15);
    width: 100%;
    max-width: 100%;
    animation: slideUp 0.25s ease-out forwards;
    min-height: calc(var(--composer-vh, var(--1dvh)) * 85);
    padding-bottom: env(safe-area-inset-bottom);
  }

  &__header {
    padding: 0.5rem;
  }

  &__body {
    flex: 1;
  }

  &.-closing {
    .d-modal__container {
      animation: slideDown 0.25s ease-out forwards;
    }
  }

  // fixes modal placement on Android when keyboard is visible
  html.keyboard-visible:not(.ios-device) & {
    height: calc(100% - env(keyboard-inset-height));

    .d-modal__container {
      max-height: 100%;
    }
  }
}

//legacy
.modal-open #main {
  overflow: hidden;
}

.modal-middle-container {
  max-width: 100%;
  margin-bottom: 30px; // For iOS Safari issues
}

// Hardcode to be the same as before for now. I would recommend not using bootbox, or finding a way so the html structure can be the same
.bootbox.modal {
  top: 10%;
  width: 100%;
}

.modal {
  &.fade {
    transition: opacity 0.3s linear, top 0.3s ease-out;
    top: -25%;
  }
  &.fade.in {
    top: 50%;
  }
  .modal-body {
    padding: 0.667em;
    overflow-y: scroll;

    > * {
      // adding box-sizing: border-box; to .modal-body causes iOS dropdown issues
      box-sizing: border-box;
    }
  }
}

.close {
  font-size: var(--font-up-4);
}

@media only screen and (max-device-width: 568px) {
  .flag-modal-body .flag-message {
    height: 3em;
  }
}

/* fix for tall modals */

.fixed-modal {
  .modal-middle-container {
    margin-bottom: 0;
  }
  .modal-inner-container {
    max-height: 90vh;
    overflow: auto;
  }

  &.insert-hyperlink-modal .modal-inner-container {
    overflow: visible;
  }

  html.keyboard-visible:not(.ios-device) & {
    height: calc(100% - env(keyboard-inset-height));

    .modal-inner-container {
      margin: auto;
    }
  }
}
